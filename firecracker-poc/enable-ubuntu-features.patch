# Kernel Config Patch for Ubuntu 24.04 Package Support
# Apply this to your working-kernel-config

# CRITICAL - USB Support (currently disabled)
CONFIG_USB=y
CONFIG_USB_SUPPORT=y
CONFIG_USB_ARCH_HAS_HCD=y
CONFIG_USB_OHCI_HCD=y
CONFIG_USB_EHCI_HCD=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_STORAGE=y
CONFIG_USB_HID=y

# CRITICAL - Block Device Support
CONFIG_BLK_DEV_SD=y
CONFIG_ATA=y  
CONFIG_SATA_AHCI=y
CONFIG_SCSI_SCAN_ASYNC=y

# CRITICAL - TUN/TAP Support (needed for your networking!)
CONFIG_TUN=y

# CRITICAL - Docker Bridge Networking Support
CONFIG_BRIDGE=y
CONFIG_BRIDGE_NETFILTER=y
CONFIG_NETFILTER=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NF_CONNTRACK=y
CONFIG_NF_CONNTRACK_MARK=y
CONFIG_NETFILTER_XT_TARGET_CONNMARK=y
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=y
CONFIG_NETFILTER_XT_MATCH_STATE=y
CONFIG_IP_NF_IPTABLES=y
CONFIG_IP_NF_FILTER=y
CONFIG_IP_NF_TARGET_REJECT=y
CONFIG_IP_NF_NAT=y
CONFIG_IP_NF_TARGET_MASQUERADE=y
CONFIG_IP_NF_MANGLE=y
CONFIG_IP6_NF_IPTABLES=y
CONFIG_IP6_NF_FILTER=y
CONFIG_IP6_NF_TARGET_REJECT=y
CONFIG_IP6_NF_NAT=y
CONFIG_IP6_NF_TARGET_MASQUERADE=y
CONFIG_IP6_NF_MANGLE=y

# CRITICAL - Container/Docker Networking
CONFIG_VETH=y
CONFIG_MACVLAN=y
CONFIG_IPVLAN=y
CONFIG_NET_CLS=y
CONFIG_NET_CLS_CGROUP=y
CONFIG_NET_CLS_BPF=y
CONFIG_NET_SCH_HTB=y
CONFIG_NET_SCH_INGRESS=y
CONFIG_NET_ACT_POLICE=y
CONFIG_NET_ACT_GACT=y
CONFIG_NET_ACT_MIRRED=y
CONFIG_NET_ACT_BPF=y

# CRITICAL - Security (Ubuntu default)
CONFIG_SECURITY_APPARMOR=y
CONFIG_DEFAULT_SECURITY_APPARMOR=y

# Graphics Support (browsers, selenium)
CONFIG_DRM=y
CONFIG_DRM_I915=y
CONFIG_DRM_AMDGPU=y
CONFIG_FB=y
CONFIG_FB_VESA=y
CONFIG_VT=y
CONFIG_VT_CONSOLE=y

# Sound Support (browsers, media tools)
CONFIG_SOUND=y
CONFIG_SND=y
CONFIG_SND_PROC_FS=y
CONFIG_SND_MIXER_OSS=y
CONFIG_SND_PCM_OSS=y
CONFIG_SND_HDA_INTEL=y

# Additional Filesystems
CONFIG_VFAT_FS=y
CONFIG_MSDOS_FS=y
CONFIG_NTFS_FS=y
CONFIG_ISO9660_FS=y
CONFIG_UDF_FS=y

# Android Development
CONFIG_ANDROID_BINDER_IPC=y
CONFIG_ANDROID=y

# Advanced Networking
CONFIG_WIRELESS=y
CONFIG_WLAN=y

# Development/Debugging
CONFIG_FTRACE=y
CONFIG_DYNAMIC_FTRACE=y
CONFIG_KPROBES=y

# HID Support (input devices)
CONFIG_HID_GENERIC=y
CONFIG_HID_BATTERY_STRENGTH=y

# Additional I/O
CONFIG_SERIO=y
CONFIG_SERIO_I8042=y 